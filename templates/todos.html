{% extends "layout.html" %}
{% set active = 'todos' -%}
{% block title %}todo åˆ—è¡¨{% endblock %}
{% block content %}
  <div class="page-header">
    <h1>Flask Todo Demo</h1>
  </div>
  <form action="/todos" method="post">
    <div class="input-group">
      <input id="todo-content" class="form-control input-lg" type="text" name="content" placeholder="æ–°å»ºä¸€ä¸ªå¾…åŠäº‹é¡¹â€¦â€¦" />
      <span class="input-group-btn">
        <button class="btn btn-success btn-lg" type="button" onclick=submit()><span class="glyphicon glyphicon-chevron-right"></span></button>
      </span>
    </div>
  </form>
  {% if not g.user %}
    <div class="alert alert-info alert-box">
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">&times;</span></button>
    <p>æœªç™»å½•çŠ¶æ€ä¸‹åˆ›å»ºçš„ todo å¯ä»¥è¢«æ‰€æœ‰äººçœ‹åˆ°å¹¶ä¿®æ”¹æˆ–åˆ é™¤ï¼Œ<a class="alert-link" href="{{ url_for('users.login') }}">ç™»å½•</a> ååˆ›å»ºçš„ todo åˆ™åªæœ‰è‡ªå·±å¯ä¿®æ”¹ã€åˆ é™¤ã€‚æƒ³è¦è®©è‡ªå·±åˆ›å»ºçš„ todo å¯¹å…¶ä»–äººä¸å¯è§ï¼Œåœ¨ä»£ç ä¸­ç§»é™¤ <code>acl.set_public_read_access(True)</code> è¿™ä¸€è¡Œå³å¯ã€‚</p>
  </div>
{% endif %}
{% with messages = get_flashed_messages() %}
{% if messages %}
  {% for message in messages %}
    <div class="alert alert-warning alert-box">
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">&times;</span></button>
    {{ message }}
  </div>
{% endfor %}
{% endif %}
{% endwith %}
<div class="btn-group todo-category-switch">
<a class="btn btn-default{% if status == 0 %} active{% endif %}" href="{{ url_for('todos.show') }}">æœªå®Œæˆ</a>
<a class="btn btn-default{% if status == 1 %} active{% endif %}" href="{{ url_for('todos.show', status=1) }}">å·²å®Œæˆ</a>
</div>
{% if not todos %}
{% if status == 0 %}
<div class="list-empty">
  <p class="text-center large-emoji">ğŸ‰</p>
  <p class="text-center lead">All Done!</p>
  <p class="text-center"><a class="text-muted" href="{{ url_for('todos.show', status=1) }}">æŸ¥çœ‹å·²å®Œæˆçš„ todo</a> æˆ–è€… <a class="text-muted" href="#" onclick=document.getElementById('todo-content').focus()>åˆ›å»ºä¸€ä¸ªæ–°çš„ todo</span></p>
</div>
{% elif status == 1 %}
<div class="list-empty">
  <p class="text-center large-emoji">ğŸ¤”</p>
  <p class="text-center lead">Wow. Nothing's Done Here.</p>
  <p class="text-center"><a class="text-muted" href="{{ url_for('todos.show', status=0) }}">å»çœ‹çœ‹æœªå®Œæˆçš„ todo</a></p>
</div>
{% endif %}
{% else %}
{% if status == 0 %}
<ul class="list-group">
  {% for todo in todos %}
    <li class="list-group-item">
      <form class="pull-right" action="{{ url_for('todos.delete', todo_id=todo.id, METHOD='DELETE', status=0) }}" method="post" id=delete-{{todo.id}}>
        <span class="glyphicon glyphicon-trash todo-delete"></span>
      </form>
      <form action="{{ url_for('todos.done', todo_id=todo.id, status=0) }}" method="post" id="done-{{todo.id}}">
        <span class="glyphicon glyphicon-unchecked"></span> {{ todo.get('content') }}
      </form>
    </li>
  {% endfor %}
</ul>
{% else %}
<ul class="list-group">
  {% for todo in todos %}
    <li class="list-group-item">
      <form class="pull-right" action="{{ url_for('todos.delete', todo_id=todo.id, METHOD='DELETE', status=1) }}" method="post" id=delete-{{todo.id}}>
        <span class="glyphicon glyphicon-trash todo-delete"></span>
      </form>
      <form action="{{ url_for('todos.undone', todo_id=todo.id, status=1) }}" method="post" id="undone-{{todo.id}}">
        <span class="glyphicon glyphicon-check text-muted"></span> <del class="text-muted">{{ todo.get('content') }}</del>
      </form>
    </li>
  {% endfor %}
</ul>
{% endif %}
<p class="text-muted"><span class="glyphicon glyphicon-info-sign"></span> {% if todos|length == 1 %}åªå‰©ä¸‹æœ€å{% else %}å…±{% endif %} {{ todos|length }} ä¸ª todoã€‚</p>
{% endif %}
{% endblock %}